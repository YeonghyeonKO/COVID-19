theme(
plot.title=element_text(size=25, hjust=0.5, face="bold", colour="black", vjust=2),
plot.subtitle=element_text(size=16, hjust=0.5, face="italic", color="maroon", vjust=2),
axis.text=element_text(size=14),
axis.title=element_text(size=16),
axis.text.x = element_text(hjust = 1, size = 12),
legend.position = "none")
p_1_2
p_2_1 <- ggplot(df_ch, aes(x = Days_after_First_Cases, y = Difference, col = Country_Region)) +
geom_line() +
geom_text_repel(
data = subset(df, Days_after_First_Cases == max(Days_after_First_Cases)),
aes(x = max(Days_after_First_Cases), label = Country_Region),
size = 3,
nudge_x = 45,
segment.color = NA
) +
labs(title = "COVID-19 Daily Cases", subtitle = "Korea, 1/20 ~ 8/17", x = "Days from First Case", y = "Confirmed Cases")+
theme_bw() +
theme(
plot.title=element_text(size=25, hjust=0.5, face="bold", colour="black", vjust=2),
plot.subtitle=element_text(size=16, hjust=0.5, face="italic", color="maroon", vjust=2),
axis.text=element_text(size=14),
axis.title=element_text(size=16),
axis.text.x = element_text(hjust = 1, size = 12),
legend.position = "none")
p_2_1
p_1_1 <- ggplot(df_ch, aes(x = Days_after_First_Cases, y = Cases, col = Country_Region)) +
geom_line() +
geom_text_repel(
data = subset(df, Days_after_First_Cases == max(Days_after_First_Cases)),
aes(x = max(Days_after_First_Cases), label = Country_Region),
size = 3,
nudge_x = 45,
segment.color = NA
) +
labs(title = "COVID-19 Confirmed Cases", subtitle = "Korea, 5/6 ~ 8/17", x = "Days from First Case", y = "Confirmed Cases")+
theme_bw() +
theme(
plot.title=element_text(size=25, hjust=0.5, face="bold", colour="black", vjust=2),
plot.subtitle=element_text(size=16, hjust=0.5, face="italic", color="maroon", vjust=2),
axis.text=element_text(size=14),
axis.title=element_text(size=16),
axis.text.x = element_text(hjust = 1, size = 12),
legend.position = "none")
p_1_1
df <- read.csv(paste0(data_path, "COVID_19_Confirmed_Korea_Stat.csv"))
View(df)
## read data
df <- read.csv(paste0(path, "Data/COVID_19_Confirmed_Korea_Merged_Fin.csv"))
df
View(df)
df_province <- df %>% filter(Country_Region == "비수도권권")
df_province
df_province <- df %>% filter(Country_Region == "비수도권")
df_province
fit <- glm(Difference ~ log(Days_after_First_Cases) + Days_after_First_Cases, data = df_province, family = poisson)
fit
ggplot()+
geom_point(aes(df_province$Days_after_First_Cases, df_province$Difference))
y <- df_province$Difference
x <- df_province$Days_after_First_Cases
y <- df_province$Difference
fit <- glm(y) ~ log(x) + x, family = poisson)
fit <- glm(y ~ log(x) + x, family = poisson)
fit
fit
fit
fit <- glm(y ~ log(x) + x, family = poisson)
fit
ggplot()+
geom_point(aes(x, y))
ggplot()+
geom_point(aes(x, y), col = "grey") +
##############################################
################# 1. fitting #################
##############################################
province_list <- unique(df$Country_Region)
ggplot()+
geom_point(aes(x, y), col = "grey")
y_s <- pracma::movavg(y, window_size, type=type)
y_s <- pracma::movavg(y, window_size = 3 , type="s")
y_s <- pracma::movavg(y, 3 , type="s")
y_s
fit_s <- glm(y_s ~ log(x) + x, family = poisson)
ggplot()+
geom_point(aes(x, y), col = "grey") +
geom_point(aes(x, y_s))
ggplot()+
geom_point(aes(x, y), col = "grey") +
geom_point(aes(x, y_s), alpha = 0.5)
ggplot()+
geom_point(aes(x, y), col = "grey") +
geom_point(aes(x, y_s), alpha = 0.7)
y_s <- pracma::movavg(y, 11, type="s")
fit <- glm(y ~ log(x) + x, family = poisson)
fit_s <- glm(y_s ~ log(x) + x, family = poisson)
ggplot()+
geom_point(aes(x, y), col = "grey") +
geom_point(aes(x, y_s), alpha = 0.7)
y_s <- pracma::movavg(y, 20, type="s")
fit <- glm(y ~ log(x) + x, family = poisson)
fit_s <- glm(y_s ~ log(x) + x, family = poisson)
ggplot()+
geom_point(aes(x, y), col = "grey") +
geom_point(aes(x, y_s), alpha = 0.7)
y_s <- pracma::movavg(y, 1, type="s")
y_s <- pracma::movavg(y, 5, type="s")
fit <- glm(y ~ log(x) + x, family = poisson)
fit_s <- glm(y_s ~ log(x) + x, family = poisson)
ggplot()+
geom_point(aes(x, y), col = "grey") +
geom_point(aes(x, y_s), alpha = 0.7)
y_s <- pracma::movavg(y, 3, type="s")
fit <- glm(y ~ log(x) + x, family = poisson)
fit_s <- glm(y_s ~ log(x) + x, family = poisson)
ggplot()+
geom_point(aes(x, y), col = "grey") +
geom_point(aes(x, y_s), alpha = 0.7)
ggplot()+
geom_point(aes(x, y), col = "grey") +
geom_point(aes(x, y_s), alpha = 0.7) +
geom_line(aes(x, fitted(fit)))
ggplot()+
geom_point(aes(x, y), col = "grey") +
geom_point(aes(x, y_s), alpha = 0.7) +
geom_line(aes(x, fitted(fit)), col = "grey")
ggplot()+
geom_point(aes(x, y), alpha = 0.5) +
geom_point(aes(x, y_s)) +
geom_line(aes(x, fitted(fit)), col = "grey")
ggplot()+
geom_point(aes(x, y), alpha = 0.5) +
geom_point(aes(x, y_s)) +
geom_line(aes(x, fitted(fit)), alpha = 0.5)
ggplot()+
geom_point(aes(x, y), alpha = 0.3) +
geom_point(aes(x, y_s)) +
geom_line(aes(x, fitted(fit)), alpha = 0.5)
ggplot()+
geom_point(aes(x, y), alpha = 0.3, col = "darkblue") +
geom_point(aes(x, y_s)) +
geom_line(aes(x, fitted(fit)), alpha = 0.5)
ggplot()+
geom_point(aes(x, y), alpha = 0.5, col = "darkblue") +
geom_point(aes(x, y_s)) +
geom_line(aes(x, fitted(fit)), alpha = 0.5)
ggplot()+
geom_point(aes(x, y), alpha = 0.5, col = "darkblue") +
geom_point(aes(x, y_s), col = "maroon") +
geom_line(aes(x, fitted(fit)), alpha = 0.5)
ggplot()+
geom_point(aes(x, y), alpha = 0.5, col = "darkblue") +
geom_point(aes(x, y_s), col = "maroon") +
geom_line(aes(x, fitted(fit)), col = "darkblue")
ggplot()+
geom_point(aes(x, y), alpha = 0.5, col = "darkblue") +
geom_point(aes(x, y_s), col = "maroon") +
geom_line(aes(x, fitted(fit)), col = "darkblue") +
geom_line(aes(x, fitted(fit_s)), col = "maroon")
seg_fit <- segmented(fit, seg.Z = ~ log(x) + x, npsi = 1, control = seg.control(display = TRUE))
ggplot()+
geom_point(aes(x, y), alpha = 0.5, col = "darkblue") +
geom_point(aes(x, y_s), col = "maroon") +
geom_line(aes(x, fitted(seg_fit)), col = "darkblue") +
geom_line(aes(x, fitted(fit_s)), col = "maroon")
ggplot()+
geom_point(aes(x, y), alpha = 0.5, col = "darkblue") +
geom_point(aes(x, y_s), alpha = 0.5, col = "maroon") +
geom_line(aes(x, fitted(seg_fit)), col = "darkblue") +
geom_line(aes(x, fitted(fit_s)), col = "maroon")
ggplot()+
geom_point(aes(x, y), alpha = 0.3, col = "darkblue") +
geom_point(aes(x, y_s), alpha = 0.3, col = "maroon") +
geom_line(aes(x, fitted(seg_fit)), col = "darkblue") +
geom_line(aes(x, fitted(fit_s)), col = "maroon")
ggplot()+
geom_point(aes(x, y), alpha = 0.3, col = "darkblue") +
geom_point(aes(x, y_s), alpha = 0.3, col = "maroon") +
geom_line(aes(x, fitted(seg_fit)), col = "darkblue", size = 1) +
geom_line(aes(x, fitted(fit_s)), col = "maroon")
ggplot()+
geom_point(aes(x, y), alpha = 0.3, col = "darkblue") +
geom_point(aes(x, y_s), alpha = 0.3, col = "maroon") +
geom_line(aes(x, fitted(seg_fit)), col = "darkblue", size = 1) +
geom_line(aes(x, fitted(fit_s)), col = "maroon", size = 1)
ggplot()+
geom_point(aes(x, y), alpha = 0.2, col = "darkblue") +
geom_point(aes(x, y_s), alpha = 0.2, col = "maroon") +
geom_line(aes(x, fitted(seg_fit)), col = "darkblue", size = 1) +
geom_line(aes(x, fitted(fit_s)), col = "maroon", size = 1)
ggplot()+
geom_point(aes(x, y), alpha = 0.3, col = "darkblue") +
geom_point(aes(x, y_s), alpha = 0.3, col = "maroon") +
geom_line(aes(x, fitted(seg_fit)), col = "darkblue", size = 1) +
geom_line(aes(x, fitted(fit_s)), col = "maroon", size = 1)
seg_fit
seg_fit_2 <- segmented(fit, seg.Z = ~ log(x) + x, npsi = 2, control = seg.control(display = TRUE))
seg_fit_3 <- segmented(fit, seg.Z = ~ log(x) + x, npsi = 3, control = seg.control(display = TRUE))
seg_fit_1 <- segmented(fit_s, seg.Z = ~ log(x) + x, npsi = 1, control = seg.control(display = TRUE))
seg_fit_2 <- segmented(fit_s, seg.Z = ~ log(x) + x, npsi = 2, control = seg.control(display = TRUE))
seg_fit_3 <- segmented(fit_s, seg.Z = ~ log(x) + x, npsi = 3, control = seg.control(display = TRUE))
y_s <- pracma::movavg(y, 5, type="s")
fit <- glm(y ~ log(x) + x, family = poisson)
fit_s <- glm(y_s ~ log(x) + x, family = poisson)
seg_fit_1 <- segmented(fit, seg.Z = ~ log(x) + x, npsi = 1, control = seg.control(display = TRUE))
seg_fit_2 <- segmented(fit, seg.Z = ~ log(x) + x, npsi = 2, control = seg.control(display = TRUE))
seg_fit_3 <- segmented(fit, seg.Z = ~ log(x) + x, npsi = 3, control = seg.control(display = TRUE))
seg_fit_1 <- segmented(fit_s, seg.Z = ~ log(x) + x, npsi = 1, control = seg.control(display = TRUE))
seg_fit_2 <- segmented(fit_s, seg.Z = ~ log(x) + x, npsi = 2, control = seg.control(display = TRUE))
seg_fit_3 <- segmented(fit_s, seg.Z = ~ log(x) + x, npsi = 3, control = seg.control(display = TRUE))
ggplot()+
geom_point(aes(x, y), alpha = 0.3, col = "darkblue") +
geom_point(aes(x, y_s), alpha = 0.3, col = "maroon") +
geom_line(aes(x, fitted(seg_fit)), col = "darkblue", size = 1) +
geom_line(aes(x, fitted(fit_s)), col = "maroon", size = 1)
ggplot()+
geom_point(aes(x, y), alpha = 0.3, col = "darkblue") +
geom_point(aes(x, y_s), alpha = 0.3, col = "maroon") +
geom_line(aes(x, fitted(seg_fit)), col = "darkblue", size = 1) +
geom_line(aes(x, fitted(fit_s)), col = "maroon", size = 1) +
theme_bw()
ggplot()+
geom_point(aes(x, y), alpha = 0.3, col = "darkblue") +
geom_point(aes(x, y_s), alpha = 0.3, col = "maroon") +
geom_line(aes(x, fitted(seg_fit)), col = "darkblue", size = 1) +
geom_line(aes(x, fitted(fit_s)), col = "maroon", size = 1) +
labs(title = "COVID-19 Confirmed Cases", subtitle = paste0("Korea, ", as.character(min(as.Date(df$Date))), "~", as.character(max(as.Date(df$Date)))), x = "Days from First Case", y = "Confirmed Cases") +
theme_bw()
ggplot()+
geom_point(aes(x, y), alpha = 0.3, col = "darkblue") +
geom_point(aes(x, y_s), alpha = 0.3, col = "maroon") +
geom_line(aes(x, fitted(seg_fit)), col = "darkblue", size = 1) +
geom_line(aes(x, fitted(fit_s)), col = "maroon", size = 1) +
labs(title = "COVID-19 Confirmed Cases", subtitle = paste0("Korea, ", as.character(min(as.Date(df$Date))), "~", as.character(max(as.Date(df$Date)))), x = "Days from First Case", y = "Confirmed Cases") +
theme_bw() +
theme(
plot.title=element_text(size=25, hjust=0.5, face="bold", colour="black", vjust=2),
plot.subtitle=element_text(size=16, hjust=0.5, face="italic", color="maroon", vjust=2),
axis.text=element_text(size=14),
axis.title=element_text(size=16),
axis.text.x = element_text(hjust = 1, size = 12),
legend.position = "none")
y_s <- pracma::movavg(y, 5, type="s")
y_s <- pracma::movavg(y, 5, type="s")
fit <- glm(y ~ log(x) + x, family = poisson)
fit_s <- glm(y_s ~ log(x) + x, family = poisson)
seg_fit_1 <- segmented(fit, seg.Z = ~ log(x) + x, npsi = 1)
seg_fit_2 <- segmented(fit, seg.Z = ~ log(x) + x, npsi = 2)
seg_fit_3 <- segmented(fit, seg.Z = ~ log(x) + x, npsi = 3)
seg_fit_1 <- segmented(fit_s, seg.Z = ~ log(x) + x, npsi = 1)
seg_fit_2 <- segmented(fit_s, seg.Z = ~ log(x) + x, npsi = 2)
seg_fit_3 <- segmented(fit_s, seg.Z = ~ log(x) + x, npsi = 3)
y_s <- pracma::movavg(y, 5, type="m")
fit_s <- glm(y_s ~ log(x) + x, family = poisson)
seg_fit_1 <- segmented(fit, seg.Z = ~ log(x) + x, npsi = 1)
seg_fit_2 <- segmented(fit, seg.Z = ~ log(x) + x, npsi = 2)
seg_fit_3 <- segmented(fit, seg.Z = ~ log(x) + x, npsi = 3)
seg_fit_1 <- segmented(fit_s, seg.Z = ~ log(x) + x, npsi = 1)
seg_fit_1
seg_fit_2 <- segmented(fit_s, seg.Z = ~ log(x) + x, npsi = 2)
seg_fit_3 <- segmented(fit_s, seg.Z = ~ log(x) + x, npsi = 3)
y_s <- pracma::movavg(y, 7, type="m")
fit_s <- glm(y_s ~ log(x) + x, family = poisson)
seg_fit_1 <- segmented(fit_s, seg.Z = ~ log(x) + x, npsi = 1)
seg_fit_1
seg_fit_2 <- segmented(fit_s, seg.Z = ~ log(x) + x, npsi = 2)
seg_fit_3 <- segmented(fit_s, seg.Z = ~ log(x) + x, npsi = 3)
y_s <- pracma::movavg(y, 9, type="m")
fit_s <- glm(y_s ~ log(x) + x, family = poisson)
seg_fit_2 <- segmented(fit_s, seg.Z = ~ log(x) + x, npsi = 2)
seg_fit_3 <- segmented(fit_s, seg.Z = ~ log(x) + x, npsi = 3)
seg_fit_3
ggplot()+
geom_point(aes(x, y), alpha = 0.3, col = "darkblue") +
geom_point(aes(x, y_s), alpha = 0.3, col = "maroon") +
geom_line(aes(x, fitted(seg_fit_3)), col = "darkblue", size = 1) +
geom_line(aes(x, fitted(fit_s)), col = "maroon", size = 1) +
labs(title = "COVID-19 Confirmed Cases", subtitle = paste0("Korea, ", as.character(min(as.Date(df$Date))), "~", as.character(max(as.Date(df$Date)))), x = "Days from First Case", y = "Confirmed Cases") +
theme_bw() +
theme(
plot.title=element_text(size=25, hjust=0.5, face="bold", colour="black", vjust=2),
plot.subtitle=element_text(size=16, hjust=0.5, face="italic", color="maroon", vjust=2),
axis.text=element_text(size=14),
axis.title=element_text(size=16),
axis.text.x = element_text(hjust = 1, size = 12),
legend.position = "none")
y_s <- pracma::movavg(y, 3, type="w")
fit_s <- glm(y_s ~ log(x) + x, family = poisson)
seg_fit_2 <- segmented(fit_s, seg.Z = ~ log(x) + x, npsi = 2)
seg_fit_3 <- segmented(fit_s, seg.Z = ~ log(x) + x, npsi = 3)
seg_fit_3 <- segmented(fit_s, seg.Z = ~ log(x) + x, npsi = 3)
seg_fit_3
ggplot()+
geom_point(aes(x, y), alpha = 0.3, col = "darkblue") +
geom_point(aes(x, y_s), alpha = 0.3, col = "maroon") +
geom_line(aes(x, fitted(seg_fit_3)), col = "darkblue", size = 1) +
geom_line(aes(x, fitted(fit_s)), col = "maroon", size = 1) +
labs(title = "COVID-19 Confirmed Cases", subtitle = paste0("Korea, ", as.character(min(as.Date(df$Date))), "~", as.character(max(as.Date(df$Date)))), x = "Days from First Case", y = "Confirmed Cases") +
theme_bw() +
theme(
plot.title=element_text(size=25, hjust=0.5, face="bold", colour="black", vjust=2),
plot.subtitle=element_text(size=16, hjust=0.5, face="italic", color="maroon", vjust=2),
axis.text=element_text(size=14),
axis.title=element_text(size=16),
axis.text.x = element_text(hjust = 1, size = 12),
legend.position = "none")
y_s <- pracma::movavg(y, 3, type="t")
fit_s <- glm(y_s ~ log(x) + x, family = poisson)
seg_fit_1 <- segmented(fit_s, seg.Z = ~ log(x) + x, npsi = 1)
seg_fit_2 <- segmented(fit_s, seg.Z = ~ log(x) + x, npsi = 2)
seg_fit_3 <- segmented(fit_s, seg.Z = ~ log(x) + x, npsi = 3)
y_s <- pracma::movavg(y, 3, type="m")
fit_s <- glm(y_s ~ log(x) + x, family = poisson)
seg_fit_2 <- segmented(fit_s, seg.Z = ~ log(x) + x, npsi = 2)
seg_fit_3 <- segmented(fit_s, seg.Z = ~ log(x) + x, npsi = 3)
y_s <- pracma::movavg(y, 5, type="m")
fit_s <- glm(y_s ~ log(x) + x, family = poisson)
seg_fit_3 <- segmented(fit_s, seg.Z = ~ log(x) + x, npsi = 3)
seg_fit_2 <- segmented(fit_s, seg.Z = ~ log(x) + x, npsi = 2)
y_s <- pracma::movavg(y, 7, type="m")
fit_s <- glm(y_s ~ log(x) + x, family = poisson)
seg_fit_2 <- segmented(fit_s, seg.Z = ~ log(x) + x, npsi = 2)
seg_fit_3 <- segmented(fit_s, seg.Z = ~ log(x) + x, npsi = 3)
y_s <- pracma::movavg(y, 9, type="m")
fit_s <- glm(y_s ~ log(x) + x, family = poisson)
seg_fit_1 <- segmented(fit_s, seg.Z = ~ log(x) + x, npsi = 1)
seg_fit_2 <- segmented(fit_s, seg.Z = ~ log(x) + x, npsi = 2)
seg_fit_3 <- segmented(fit_s, seg.Z = ~ log(x) + x, npsi = 3)
y_s <- pracma::movavg(y, 11, type="m")
fit_s <- glm(y_s ~ log(x) + x, family = poisson)
seg_fit_2 <- segmented(fit_s, seg.Z = ~ log(x) + x, npsi = 2)
seg_fit_3 <- segmented(fit_s, seg.Z = ~ log(x) + x, npsi = 3)
ggplot()+
geom_point(aes(x, y), alpha = 0.3, col = "darkblue") +
geom_point(aes(x, y_s), alpha = 0.3, col = "maroon") +
geom_line(aes(x, fitted(seg_fit_2)), col = "darkblue", size = 1) +
geom_line(aes(x, fitted(fit_s)), col = "maroon", size = 1) +
labs(title = "COVID-19 Confirmed Cases", subtitle = paste0("Korea, ", as.character(min(as.Date(df$Date))), "~", as.character(max(as.Date(df$Date)))), x = "Days from First Case", y = "Confirmed Cases") +
theme_bw() +
theme(
plot.title=element_text(size=25, hjust=0.5, face="bold", colour="black", vjust=2),
plot.subtitle=element_text(size=16, hjust=0.5, face="italic", color="maroon", vjust=2),
axis.text=element_text(size=14),
axis.title=element_text(size=16),
axis.text.x = element_text(hjust = 1, size = 12),
legend.position = "none")
ggplot()+
geom_point(aes(x, y), alpha = 0.3, col = "darkblue") +
geom_point(aes(x, y_s), alpha = 0.3, col = "maroon") +
geom_line(aes(x, fitted(seg_fit_2)), col = "darkblue", size = 1) +
labs(title = "COVID-19 Confirmed Cases", subtitle = paste0("Korea, ", as.character(min(as.Date(df$Date))), "~", as.character(max(as.Date(df$Date)))), x = "Days from First Case", y = "Confirmed Cases") +
theme_bw() +
theme(
plot.title=element_text(size=25, hjust=0.5, face="bold", colour="black", vjust=2),
plot.subtitle=element_text(size=16, hjust=0.5, face="italic", color="maroon", vjust=2),
axis.text=element_text(size=14),
axis.title=element_text(size=16),
axis.text.x = element_text(hjust = 1, size = 12),
legend.position = "none")
ggplot()+
geom_point(aes(x, y), alpha = 0.3, col = "darkblue") +
geom_point(aes(x, y_s), alpha = 0.3, col = "maroon") +
geom_line(aes(x, fitted(seg_fit_2)), col = 2, size = 1) +
labs(title = "COVID-19 Confirmed Cases", subtitle = paste0("Korea, ", as.character(min(as.Date(df$Date))), "~", as.character(max(as.Date(df$Date)))), x = "Days from First Case", y = "Confirmed Cases") +
theme_bw() +
theme(
plot.title=element_text(size=25, hjust=0.5, face="bold", colour="black", vjust=2),
plot.subtitle=element_text(size=16, hjust=0.5, face="italic", color="maroon", vjust=2),
axis.text=element_text(size=14),
axis.title=element_text(size=16),
axis.text.x = element_text(hjust = 1, size = 12),
legend.position = "none")
seg_fit_3
y_s <- pracma::movavg(y, 9, type="m")
fit_s <- glm(y_s ~ log(x) + x, family = poisson)
seg_fit_2 <- segmented(fit_s, seg.Z = ~ log(x) + x, npsi = 2)
seg_fit_3 <- segmented(fit_s, seg.Z = ~ log(x) + x, npsi = 3)
ggplot()+
geom_point(aes(x, y), alpha = 0.3, col = "darkblue") +
geom_point(aes(x, y_s), alpha = 0.3, col = "maroon") +
geom_line(aes(x, fitted(seg_fit_2)), col = 2, size = 1) +
labs(title = "COVID-19 Confirmed Cases", subtitle = paste0("Korea, ", as.character(min(as.Date(df$Date))), "~", as.character(max(as.Date(df$Date)))), x = "Days from First Case", y = "Confirmed Cases") +
theme_bw() +
theme(
plot.title=element_text(size=25, hjust=0.5, face="bold", colour="black", vjust=2),
plot.subtitle=element_text(size=16, hjust=0.5, face="italic", color="maroon", vjust=2),
axis.text=element_text(size=14),
axis.title=element_text(size=16),
axis.text.x = element_text(hjust = 1, size = 12),
legend.position = "none")
df
View(df)
df_seoul <- df %>% filter(Country_Region == "수도권(서울+경기+인천)")
df_province <- df %>% filter(Country_Region == "수도권(서울+경기+인천)")
df_province <- df %>% filter(Country_Region == "수도권(서울+경기+인천)")
x <- df_province$Days_after_First_Cases
y <- df_province$Difference
y_s <- pracma::movavg(y, 9, type="m")
fit <- glm(y ~ log(x) + x, family = poisson)
fit_s <- glm(y_s ~ log(x) + x, family = poisson)
seg_fit_1 <- segmented(fit, seg.Z = ~ log(x) + x, npsi = 1)
seg_fit_2 <- segmented(fit, seg.Z = ~ log(x) + x, npsi = 2)
seg_fit_3 <- segmented(fit, seg.Z = ~ log(x) + x, npsi = 3)
seg_fit_1 <- segmented(fit_s, seg.Z = ~ log(x) + x, npsi = 1)
seg_fit_2 <- segmented(fit_s, seg.Z = ~ log(x) + x, npsi = 2)
seg_fit_3 <- segmented(fit_s, seg.Z = ~ log(x) + x, npsi = 3)
ggplot()+
geom_point(aes(x, y), alpha = 0.3, col = "darkblue") +
geom_point(aes(x, y_s), alpha = 0.3, col = "maroon") +
geom_line(aes(x, fitted(seg_fit_1)), col = 2, size = 1) +
labs(title = "COVID-19 Confirmed Cases", subtitle = paste0("Korea, ", as.character(min(as.Date(df$Date))), "~", as.character(max(as.Date(df$Date)))), x = "Days from First Case", y = "Confirmed Cases") +
theme_bw() +
theme(
plot.title=element_text(size=25, hjust=0.5, face="bold", colour="black", vjust=2),
plot.subtitle=element_text(size=16, hjust=0.5, face="italic", color="maroon", vjust=2),
axis.text=element_text(size=14),
axis.title=element_text(size=16),
axis.text.x = element_text(hjust = 1, size = 12),
legend.position = "none")
y_s <- pracma::movavg(y, 3, type="m")
fit_s <- glm(y_s ~ log(x) + x, family = poisson)
seg_fit_1 <- segmented(fit_s, seg.Z = ~ log(x) + x, npsi = 1)
seg_fit_2 <- segmented(fit_s, seg.Z = ~ log(x) + x, npsi = 2)
seg_fit_3 <- segmented(fit_s, seg.Z = ~ log(x) + x, npsi = 3)
ggplot()+
geom_point(aes(x, y), alpha = 0.3, col = "darkblue") +
geom_point(aes(x, y_s), alpha = 0.3, col = "maroon") +
geom_line(aes(x, fitted(seg_fit_1)), col = 2, size = 1) +
labs(title = "COVID-19 Confirmed Cases", subtitle = paste0("Korea, ", as.character(min(as.Date(df$Date))), "~", as.character(max(as.Date(df$Date)))), x = "Days from First Case", y = "Confirmed Cases") +
theme_bw() +
theme(
plot.title=element_text(size=25, hjust=0.5, face="bold", colour="black", vjust=2),
plot.subtitle=element_text(size=16, hjust=0.5, face="italic", color="maroon", vjust=2),
axis.text=element_text(size=14),
axis.title=element_text(size=16),
axis.text.x = element_text(hjust = 1, size = 12),
legend.position = "none")
ggplot()+
geom_point(aes(x, y), alpha = 0.3, col = "darkblue") +
geom_point(aes(x, y_s), alpha = 0.3, col = "maroon") +
geom_line(aes(x, fitted(seg_fit_2)), col = 2, size = 1) +
labs(title = "COVID-19 Confirmed Cases", subtitle = paste0("Korea, ", as.character(min(as.Date(df$Date))), "~", as.character(max(as.Date(df$Date)))), x = "Days from First Case", y = "Confirmed Cases") +
theme_bw() +
theme(
plot.title=element_text(size=25, hjust=0.5, face="bold", colour="black", vjust=2),
plot.subtitle=element_text(size=16, hjust=0.5, face="italic", color="maroon", vjust=2),
axis.text=element_text(size=14),
axis.title=element_text(size=16),
axis.text.x = element_text(hjust = 1, size = 12),
legend.position = "none")
ggplot()+
geom_point(aes(x, y), alpha = 0.3, col = "darkblue") +
geom_point(aes(x, y_s), alpha = 0.3, col = "maroon") +
geom_line(aes(x, fitted(seg_fit_3)), col = 2, size = 1) +
labs(title = "COVID-19 Confirmed Cases", subtitle = paste0("Korea, ", as.character(min(as.Date(df$Date))), "~", as.character(max(as.Date(df$Date)))), x = "Days from First Case", y = "Confirmed Cases") +
theme_bw() +
theme(
plot.title=element_text(size=25, hjust=0.5, face="bold", colour="black", vjust=2),
plot.subtitle=element_text(size=16, hjust=0.5, face="italic", color="maroon", vjust=2),
axis.text=element_text(size=14),
axis.title=element_text(size=16),
axis.text.x = element_text(hjust = 1, size = 12),
legend.position = "none")
View(df)
df_province <- df %>% filter(Country_Region == "전국(지역)")
x <- df_province$Days_after_First_Cases
y <- df_province$Difference
y_s <- pracma::movavg(y, 3, type="m")
fit <- glm(y ~ log(x) + x, family = poisson)
fit_s <- glm(y_s ~ log(x) + x, family = poisson)
seg_fit_2 <- segmented(fit_s, seg.Z = ~ log(x) + x, npsi = 2)
seg_fit_3 <- segmented(fit_s, seg.Z = ~ log(x) + x, npsi = 3)
ggplot()+
geom_point(aes(x, y), alpha = 0.3, col = "darkblue") +
geom_point(aes(x, y_s), alpha = 0.3, col = "maroon") +
geom_line(aes(x, fitted(seg_fit_2)), col = 2, size = 1) +
labs(title = "COVID-19 Confirmed Cases", subtitle = paste0("Korea, ", as.character(min(as.Date(df$Date))), "~", as.character(max(as.Date(df$Date)))), x = "Days from First Case", y = "Confirmed Cases") +
theme_bw() +
theme(
plot.title=element_text(size=25, hjust=0.5, face="bold", colour="black", vjust=2),
plot.subtitle=element_text(size=16, hjust=0.5, face="italic", color="maroon", vjust=2),
axis.text=element_text(size=14),
axis.title=element_text(size=16),
axis.text.x = element_text(hjust = 1, size = 12),
legend.position = "none")
ggplot()+
geom_point(aes(x, y), alpha = 0.3, col = "darkblue") +
geom_point(aes(x, y_s), alpha = 0.3, col = "maroon") +
geom_line(aes(x, fitted(seg_fit_2)), col = 2, size = 1) +
labs(title = "COVID-19 Confirmed Cases", subtitle = paste0("Korea, ", as.character(min(as.Date(df$Date))), "~", as.character(max(as.Date(df$Date)))), x = "Days from First Case", y = "Confirmed Cases") +
theme_bw() +
theme(
plot.title=element_text(size=25, hjust=0.5, face="bold", colour="black", vjust=2),
plot.subtitle=element_text(size=16, hjust=0.5, face="italic", color="maroon", vjust=2),
axis.text=element_text(size=14),
axis.title=element_text(size=16),
axis.text.x = element_text(hjust = 1, size = 12),
legend.position = "none")
ggplot()+
geom_point(aes(x, y), alpha = 0.3, col = "darkblue") +
geom_point(aes(x, y_s), alpha = 0.3, col = "maroon") +
geom_line(aes(x, fitted(seg_fit_3)), col = 2, size = 1) +
labs(title = "COVID-19 Confirmed Cases", subtitle = paste0("Korea, ", as.character(min(as.Date(df$Date))), "~", as.character(max(as.Date(df$Date)))), x = "Days from First Case", y = "Confirmed Cases") +
theme_bw() +
theme(
plot.title=element_text(size=25, hjust=0.5, face="bold", colour="black", vjust=2),
plot.subtitle=element_text(size=16, hjust=0.5, face="italic", color="maroon", vjust=2),
axis.text=element_text(size=14),
axis.title=element_text(size=16),
axis.text.x = element_text(hjust = 1, size = 12),
legend.position = "none")
